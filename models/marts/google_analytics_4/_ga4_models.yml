
version: 2         

models:
  - name: ga4__events
    description: The ga4__events marts model is a comprehensive and structured representation of Google Analytics 4 events data. It consolidates the staged GA4 events data from the stg__ga4_events staging model, making it suitable for further analysis and reporting. The model is organized within the marts_google_analytics_4 schema and is partitioned by the event_date field for optimized query performance. The unique key for this model is surrogate_key, ensuring the data's uniqueness and consistency.
    tests:
      - duplicate_rows
      - dbt_expectations.expect_table_aggregation_to_equal_other_table:
          expression: count(*)
          compare_model: ref("stg_union_events_tables")
          compare_expression: count(*)
          tolerance_percent: 1
    columns: 
      - name: event_date
        tests: 
          - null_1_pct
      - name: event_name
        tests: 
          - null_1_pct
      - name: user_id
        description: Unique identifier for the user.
      - name: user_pseudo_id
        description: Pseudonymous identifier for the user.
      - name: stream_id
        description: Unique identifier for the data stream.
      - name: event_bundle_sequence_id
        description: Identifier for the sequence of event bundles.
      - name: device_vendor_id
        description: Identifier for the device vendor.
      - name: device_advertising_id
        description: Advertising identifier for the device.
      - name: items.item_id
        description: Unique identifier for the item.
      - name: items.location_id
        description: Identifier for the item location.
      - name: items.item_list_id
        description: Identifier for the item list.
      - name: items.promotion_id
        description: Identifier for the promotion associated with the item.
      - name: hostname
        description: Extracted hostname from the page_location parameter.
      - name: geo_region
        description: Geographical region associated with the event.
      - name: geo_city
        description: City associated with the event.
      - name: geo_country
        description: Country associated with the event.
      - name: geo_continent
        description: Continent associated with the event.
      - name: geo_sub_continent
        description: Sub-continent associated with the event.
      - name: geo_metro
        description: Metro area associated with the event.
      - name: device_category
        description: Category of the device.
      - name: device_mobile_brand_name
        description: Mobile brand name of the device.
      - name: device_mobile_model_name
        description: Mobile model name of the device.
      - name: device_mobile_marketing_name
        description: Mobile marketing name of the device.
      - name: device_mobile_os_hardware_model
        description: Mobile operating system hardware model of the device.
      - name: device_operating_system
        description: Operating system of the device.
      - name: device_operating_system_version
        description: Operating system version of the device.
      - name: device_language
        description: Language setting of the device.
      - name: device_is_limited_ad_tracking
        description: Flag indicating if the device has limited ad tracking enabled.
      - name: device_time_zone_offset_seconds
        description: Time zone offset in seconds for the device.
      - name: device_browser
        description: Browser used on the device.
      - name: device_browser_version
        description: Browser version used on the device.
      - name: items.item_name
        description: Name of the item.
      - name: items.item_brand
        description: Brand of the item.
      - name: items.item_variant
        description: Variant of the item.
      - name: items.item_category
        description: Primary category of the item.
      - name: items.item_category2
        description: Secondary category of the item.
      - name: items.item_category3
        description: Tertiary category of the item.
      - name: items.item_category4
        description: Fourth category level of the item.
      - name: items.item_category5
        description: Fifth category level of the item.
      - name: items.price_in_usd
        description: Price of the item in USD.
      - name: items.price
        description: Price of the item in its original currency.
      - name: items.quantity
        description: Quantity of the item.
      - name: items.item_revenue_in_usd
        description: Revenue generated by the item in USD.
      - name: items.item_revenue
        description: Revenue generated by the item in its original currency.
      - name: items.item_refund_in_usd
        description: Refund amount for the item in USD.
      - name: items.item_refund
        description: Refund amount for the item in its original currency.
      - name: items.coupon
        description: Coupon code associated with the item.
      - name: items.affiliation
        description: Affiliation associated with the item.
      - name: items.item_list_name
        description: Name of the item list.
      - name: items.item_list_index
        description: Index of the item in the item list.
      - name: items.promotion_name
        description: Name of the promotion associated with the item.
      - name: items.creative_name
        description: Name of the creative associated with the item.
      - name: items.creative_slot
        description: Slot of the creative associated with the item.
      - name: ecommerce_total_item_quantity
        description: Total item quantity in the ecommerce transaction.
      - name: ecommerce_purchase_revenue_in_usd
        description: Purchase revenue of the ecommerce transaction in USD.
      - name: ecommerce_purchase_revenue
        description: Purchase revenue of the ecommerce transaction in its original currency.
      - name: ecommerce_refund_value_in_usd
        description: Refund value of the ecommerce transaction in USD.
      - name: ecommerce_refund_value
        description: Refund value of the ecommerce transaction in its original currency.
      - name: ecommerce_shipping_value_in_usd
        description: Shipping value of the ecommerce transaction in USD.
      - name: ecommerce_shipping_value
        description: Shipping value of the ecommerce transaction in its original currency.
      - name: ecommerce_tax_value_in_usd
        description: Tax value of the ecommerce transaction in USD.
      - name: ecommerce_tax_value
        description: Tax value of the ecommerce transaction in its original currency.
      - name: ecommerce_unique_items
        description: Number of unique items in the ecommerce transaction.
      - name: ecommerce_transaction_id
        description: Identifier for the ecommerce transaction.
      - name: user_ltv_revenue
        description: User lifetime value revenue.
      - name: user_ltv_currency
        description: Currency of the user lifetime value revenue.
      - name: event_value_in_usd
        description: Event value in USD.
      - name: privacy_info_analytics_storage
        description: Analytics storage information for privacy purposes.
      - name: privacy_info_ads_storage
        description: Ads storage information for privacy purposes.
      - name: privacy_info_uses_transient_token
        description: Flag indicating if the event uses a transient token for privacy purposes.
      - name: app_info_id
        description: Identifier for the app.
      - name: app_info_version
        description: Version of the app.
      - name: app_info_install_store
        description: App store where the app was installed.
      - name: app_info_firebase_app_id
        description: Firebase app identifier.
      - name: app_info_install_source
        description: Source of the app installation.
      - name: traffic_source_name
        description: Name of the traffic source.
      - name: traffic_source_medium
        description: Medium of the traffic source.
      - name: traffic_source_source
        description: Source of the traffic.
      - name: platform
        description: Platform of the event (e.g., web or app).
      - name: event_dimensions_hostname
        description: Hostname associated with the event dimensions.
      - name: exit_page
        description: Exit page of the session.
      - name: event_timestamp
        description: Timestamp of the event.
      - name: event_previous_timestamp
        description: Timestamp of the previous event.
      - name: event_server_timestamp_offset
        description: Server timestamp offset of the event.
      - name: user_first_touch_timestamp
